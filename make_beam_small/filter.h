#ifndef FILTER_H
#define FILTER_H

#define REAL_COEFFS  0
#define CPLX_COEFFS  1

#include "mycomplex.h"

void load_filter( char *filename, int dtype, ComplexDouble *filter );

void apply_phase_ramp( ComplexDouble *in, int size, double slope,
                       ComplexDouble *out );

ComplexDouble **apply_mult_phase_ramps( ComplexDouble *in,
                                         int size, int N );

void fir_filter_1D( ComplexDouble *fil, int fil_size, ComplexDouble *signal,
                    int size, ComplexDouble *res );

#define FINE_PFB_FILTER_SIZE    1536
#define FINE_PFB_FILTER_COEFFS  { \
    0, 0, 0, 0, 0, 0, 0, 0, \
    0, -1, -1, -1, -1, -2, -2, -3, \
    -3, -4, -4, -5, -6, -7, -8, -9, \
    -10, -11, -12, -13, -15, -16, -18, -20, \
    -22, -23, -25, -27, -30, -32, -34, -37, \
    -39, -42, -45, -47, -50, -53, -56, -59, \
    -62, -66, -69, -72, -76, -79, -83, -86, \
    -90, -94, -97, -101, -105, -109, -113, -116, \
    -120, -124, -128, -131, -135, -139, -142, -146, \
    -149, -153, -156, -159, -162, -166, -168, -171, \
    -174, -176, -179, -181, -183, -185, -187, -188, \
    -190, -191, -192, -192, -193, -193, -193, -192, \
    -192, -191, -190, -188, -187, -184, -182, -179, \
    -176, -173, -169, -165, -160, -155, -150, -145, \
    -139, -132, -125, -118, -111, -103, -94, -85, \
    -76, -67, -57, -46, -35, -24, -12, 0, \
    13, 26, 39, 53, 67, 81, 96, 112, \
    128, 144, 160, 177, 194, 212, 230, 248, \
    267, 286, 305, 325, 345, 365, 385, 406, \
    426, 448, 469, 490, 512, 534, 556, 578, \
    600, 622, 644, 667, 689, 711, 734, 756, \
    778, 800, 822, 844, 866, 888, 909, 931, \
    952, 972, 993, 1013, 1033, 1052, 1072, 1090, \
    1108, 1126, 1144, 1160, 1177, 1192, 1207, 1222, \
    1236, 1249, 1262, 1273, 1284, 1295, 1304, 1313, \
    1321, 1328, 1334, 1339, 1343, 1347, 1349, 1351, \
    1351, 1350, 1349, 1346, 1342, 1337, 1331, 1323, \
    1315, 1305, 1295, 1283, 1269, 1255, 1239, 1222, \
    1204, 1184, 1164, 1141, 1118, 1093, 1067, 1040, \
    1011, 981, 950, 918, 884, 848, 812, 774, \
    735, 695, 653, 610, 566, 520, 473, 425, \
    376, 326, 274, 222, 168, 113, 57, 0, \
    -58, -117, -177, -238, -300, -363, -427, -492, \
    -557, -623, -690, -758, -826, -895, -964, -1034, \
    -1104, -1175, -1246, -1318, -1390, -1462, -1534, -1607, \
    -1679, -1752, -1824, -1897, -1969, -2042, -2114, -2185, \
    -2257, -2328, -2398, -2468, -2538, -2607, -2675, -2742, \
    -2809, -2874, -2939, -3003, -3066, -3127, -3188, -3247, \
    -3305, -3361, -3416, -3470, -3522, -3573, -3621, -3668, \
    -3714, -3757, -3799, -3838, -3876, -3911, -3945, -3976, \
    -4005, -4031, -4056, -4078, -4097, -4114, -4129, -4140, \
    -4150, -4156, -4160, -4161, -4159, -4155, -4147, -4137, \
    -4123, -4107, -4088, -4065, -4040, -4011, -3980, -3945, \
    -3907, -3866, -3822, -3774, -3723, -3669, -3612, -3552, \
    -3488, -3421, -3351, -3277, -3201, -3121, -3038, -2952, \
    -2862, -2770, -2674, -2575, -2473, -2368, -2260, -2149, \
    -2035, -1918, -1798, -1675, -1550, -1421, -1290, -1157, \
    -1021, -882, -741, -597, -451, -303, -153, 0, \
    155, 311, 470, 630, 792, 956, 1121, 1288, \
    1456, 1625, 1796, 1967, 2140, 2313, 2488, 2662, \
    2838, 3014, 3190, 3367, 3543, 3720, 3896, 4072, \
    4248, 4423, 4598, 4772, 4945, 5117, 5288, 5458, \
    5626, 5793, 5958, 6121, 6283, 6442, 6600, 6755, \
    6907, 7057, 7205, 7349, 7491, 7630, 7765, 7897, \
    8025, 8150, 8272, 8389, 8502, 8612, 8717, 8818, \
    8914, 9006, 9093, 9175, 9252, 9324, 9392, 9453, \
    9510, 9561, 9607, 9646, 9680, 9709, 9731, 9747, \
    9757, 9761, 9759, 9750, 9735, 9714, 9686, 9651, \
    9609, 9561, 9506, 9445, 9376, 9300, 9218, 9128, \
    9032, 8928, 8818, 8700, 8575, 8443, 8304, 8158, \
    8005, 7845, 7678, 7503, 7322, 7134, 6938, 6736, \
    6527, 6311, 6089, 5859, 5623, 5381, 5132, 4876, \
    4615, 4347, 4072, 3792, 3506, 3214, 2916, 2613, \
    2304, 1990, 1671, 1346, 1017, 682, 343, 0, \
    -348, -700, -1056, -1415, -1779, -2145, -2516, -2889, \
    -3265, -3644, -4025, -4408, -4794, -5181, -5570, -5961, \
    -6352, -6745, -7138, -7532, -7926, -8320, -8714, -9107, \
     -9499,  -9891, -10281, -10670, -11057, -11442, -11824, -12204, \
    -12581, -12955, -13326, -13693, -14056, -14415, -14770, -15119, \
    -15464, -15803, -16137, -16465, -16786, -17102, -17410, -17712, \
    -18006, -18293, -18572, -18843, -19106, -19360, -19605, -19841, \
    -20067, -20284, -20491, -20688, -20874, -21049, -21214, -21367, \
    -21508, -21638, -21756, -21862, -21956, -22036, -22104, -22159, \
    -22200, -22228, -22242, -22242, -22228, -22200, -22157, -22099, \
    -22027, -21939, -21836, -21718, -21584, -21434, -21269, -21088, \
    -20890, -20676, -20446, -20200, -19936, -19656, -19360, -19046, \
    -18716, -18368, -18004, -17622, -17223, -16807, -16374, -15923, \
    -15456, -14970, -14468, -13948, -13411, -12857, -12285, -11697, \
    -11091, -10468,  -9828,  -9171,  -8497,  -7806,  -7099,  -6375, \
     -5634,  -4877,  -4104,  -3315,  -2510,  -1689,   -852,      0, \
       867,   1750,   2648,   3560,   4487,   5428,   6383,   7353, \
      8335,   9332,  10341,  11363,  12398,  13445,  14504,  15575, \
     16658,  17752,  18856,  19971,  21097,  22232,  23377,  24531, \
     25694,  26866,  28045,  29233,  30428,  31630,  32839,  34054, \
     35275,  36502,  37734,  38971,  40212,  41457,  42705,  43957, \
     45211,  46468,  47727,  48987,  50248,  51509,  52771,  54032, \
     55293,  56553,  57811,  59067,  60320,  61571,  62818,  64062, \
     65301,  66535,  67765,  68988,  70206,  71417,  72622,  73819, \
     75008,  76189,  77361,  78524,  79678,  80822,  81955,  83078, \
     84189,  85289,  86377,  87452,  88514,  89563,  90599,  91620, \
     92627,  93619,  94596,  95557,  96503,  97432,  98344,  99240, \
    100118, 100978, 101820, 102644, 103450, 104236, 105003, 105751, \
    106478, 107185, 107872, 108539, 109184, 109808, 110411, 110992, \
    111551, 112087, 112602, 113094, 113563, 114009, 114432, 114832, \
    115209, 115561, 115891, 116196, 116477, 116734, 116967, 117176, \
    117360, 117520, 117656, 117767, 117853, 117915, 117952, 117964, \
    117952, 117915, 117853, 117767, 117656, 117520, 117360, 117176, \
    116967, 116734, 116477, 116196, 115891, 115561, 115209, 114832, \
    114432, 114009, 113563, 113094, 112602, 112087, 111551, 110992, \
    110411, 109808, 109184, 108539, 107872, 107185, 106478, 105751, \
    105003, 104236, 103450, 102644, 101820, 100978, 100118,  99240, \
     98344,  97432,  96503,  95557,  94596,  93619,  92627,  91620, \
     90599,  89563,  88514,  87452,  86377,  85289,  84189,  83078, \
     81955,  80822,  79678,  78524,  77361,  76189,  75008,  73819, \
     72622,  71417,  70206,  68988,  67765,  66535,  65301,  64062, \
     62818,  61571,  60320,  59067,  57811,  56553,  55293,  54032, \
     52771,  51509,  50248,  48987,  47727,  46468,  45211,  43957, \
     42705,  41457,  40212,  38971,  37734,  36502,  35275,  34054, \
     32839,  31630,  30428,  29233,  28045,  26866,  25694,  24531, \
     23377,  22232,  21097,  19971,  18856,  17752,  16658,  15575, \
     14504,  13445,  12398,  11363,  10341,   9332,   8335,   7353, \
      6383,   5428,   4487,   3560,   2648,   1750,    867,      0, \
      -852,  -1689,  -2510,  -3315,  -4104,  -4877,  -5634,  -6375, \
     -7099,  -7806,  -8497,  -9171,  -9828, -10468, -11091, -11697, \
    -12285, -12857, -13411, -13948, -14468, -14970, -15456, -15923, \
    -16374, -16807, -17223, -17622, -18004, -18368, -18716, -19046, \
    -19360, -19656, -19936, -20200, -20446, -20676, -20890, -21088, \
    -21269, -21434, -21584, -21718, -21836, -21939, -22027, -22099, \
    -22157, -22200, -22228, -22242, -22242, -22228, -22200, -22159, \
    -22104, -22036, -21956, -21862, -21756, -21638, -21508, -21367, \
    -21214, -21049, -20874, -20688, -20491, -20284, -20067, -19841, \
    -19605, -19360, -19106, -18843, -18572, -18293, -18006, -17712, \
    -17410, -17102, -16786, -16465, -16137, -15803, -15464, -15119, \
    -14770, -14415, -14056, -13693, -13326, -12955, -12581, -12204, \
    -11824, -11442, -11057, -10670, -10281,  -9891,  -9499,  -9107, \
     -8714,  -8320,  -7926,  -7532,  -7138,  -6745,  -6352,  -5961, \
     -5570,  -5181,  -4794,  -4408,  -4025,  -3644,  -3265,  -2889, \
     -2516,  -2145,  -1779,  -1415,  -1056,   -700,   -348,      0, \
       343,    682,   1017,   1346,   1671,   1990,   2304,   2613, \
      2916,   3214,   3506,   3792,   4072,   4347,   4615,   4876, \
      5132,   5381,   5623,   5859,   6089,   6311,   6527,   6736, \
      6938,   7134,   7322,   7503,   7678,   7845,   8005,   8158, \
      8304,   8443,   8575,   8700,   8818,   8928,   9032,   9128, \
      9218,   9300,   9376,   9445,   9506,   9561,   9609,   9651, \
      9686,   9714,   9735,   9750,   9759,   9761,   9757,   9747, \
      9731,   9709,   9680,   9646,   9607,   9561,   9510,   9453, \
      9392,   9324,   9252,   9175,   9093,   9006,   8914,   8818, \
      8717,   8612,   8502,   8389,   8272,   8150,   8025,   7897, \
      7765,   7630,   7491,   7349,   7205,   7057,   6907,   6755, \
      6600,   6442,   6283,   6121,   5958,   5793,   5626,   5458, \
      5288,   5117,   4945,   4772,   4598,   4423,   4248,   4072, \
      3896,   3720,   3543,   3367,   3190,   3014,   2838,   2662, \
      2488,   2313,   2140,   1967,   1796,   1625,   1456,   1288, \
      1121,    956,    792,    630,    470,    311,    155,      0, \
    -153, -303, -451, -597, -741, -882, -1021, -1157, \
    -1290, -1421, -1550, -1675, -1798, -1918, -2035, -2149, \
    -2260, -2368, -2473, -2575, -2674, -2770, -2862, -2952, \
    -3038, -3121, -3201, -3277, -3351, -3421, -3488, -3552, \
    -3612, -3669, -3723, -3774, -3822, -3866, -3907, -3945, \
    -3980, -4011, -4040, -4065, -4088, -4107, -4123, -4137, \
    -4147, -4155, -4159, -4161, -4160, -4156, -4150, -4140, \
    -4129, -4114, -4097, -4078, -4056, -4031, -4005, -3976, \
    -3945, -3911, -3876, -3838, -3799, -3757, -3714, -3668, \
    -3621, -3573, -3522, -3470, -3416, -3361, -3305, -3247, \
    -3188, -3127, -3066, -3003, -2939, -2874, -2809, -2742, \
    -2675, -2607, -2538, -2468, -2398, -2328, -2257, -2185, \
    -2114, -2042, -1969, -1897, -1824, -1752, -1679, -1607, \
    -1534, -1462, -1390, -1318, -1246, -1175, -1104, -1034, \
    -964, -895, -826, -758, -690, -623, -557, -492, \
    -427, -363, -300, -238, -177, -117, -58, 0, \
    57, 113, 168, 222, 274, 326, 376, 425, \
    473, 520, 566, 610, 653, 695, 735, 774, \
    812, 848, 884, 918, 950, 981, 1011, 1040, \
    1067, 1093, 1118, 1141, 1164, 1184, 1204, 1222, \
    1239, 1255, 1269, 1283, 1295, 1305, 1315, 1323, \
    1331, 1337, 1342, 1346, 1349, 1350, 1351, 1351, \
    1349, 1347, 1343, 1339, 1334, 1328, 1321, 1313, \
    1304, 1295, 1284, 1273, 1262, 1249, 1236, 1222, \
    1207, 1192, 1177, 1160, 1144, 1126, 1108, 1090, \
    1072, 1052, 1033, 1013, 993, 972, 952, 931, \
    909, 888, 866, 844, 822, 800, 778, 756, \
    734, 711, 689, 667, 644, 622, 600, 578, \
    556, 534, 512, 490, 469, 448, 426, 406, \
    385, 365, 345, 325, 305, 286, 267, 248, \
    230, 212, 194, 177, 160, 144, 128, 112, \
    96, 81, 67, 53, 39, 26, 13, 0, \
    -12, -24, -35, -46, -57, -67, -76, -85, \
    -94, -103, -111, -118, -125, -132, -139, -145, \
    -150, -155, -160, -165, -169, -173, -176, -179, \
    -182, -184, -187, -188, -190, -191, -192, -192, \
    -193, -193, -193, -192, -192, -191, -190, -188, \
    -187, -185, -183, -181, -179, -176, -174, -171, \
    -168, -166, -162, -159, -156, -153, -149, -146, \
    -142, -139, -135, -131, -128, -124, -120, -116, \
    -113, -109, -105, -101, -97, -94, -90, -86, \
    -83, -79, -76, -72, -69, -66, -62, -59, \
    -56, -53, -50, -47, -45, -42, -39, -37, \
    -34, -32, -30, -27, -25, -23, -22, -20, \
    -18, -16, -15, -13, -12, -11, -10, -9, \
    -8, -7, -6, -5, -4, -4, -3, -3, \
    -2, -2, -1, -1, -1, -1, 0, 0, \
    0, 0, 0, 0, 0, 0, 0, 0 }

#endif
